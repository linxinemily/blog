<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Emmie&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://linxinemily.github.io/"/>
  <updated>2022-07-17T17:43:03.035Z</updated>
  <id>https://linxinemily.github.io/</id>
  
  <author>
    <name>Emmie</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä½¿Laravel IoC Container å¦‚ä½•è§£æ Controller method ç•¶ä¸­çš„ä¾è³´(DI)</title>
    <link href="https://linxinemily.github.io/2022/07/18/Laravel%20IoC%20Container%20%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90%20Controller%20method%20%E7%95%B6%E4%B8%AD%E7%9A%84%E4%BE%9D%E8%B3%B4/"/>
    <id>https://linxinemily.github.io/2022/07/18/Laravel IoC Container å¦‚ä½•è§£æ Controller method ç•¶ä¸­çš„ä¾è³´/</id>
    <published>2022-07-17T17:08:19.854Z</published>
    <updated>2022-07-17T17:43:03.035Z</updated>
    
    <content type="html"><![CDATA[<aside>ğŸ’¡ ç”±æ–¼ä»¥ä¸‹æ‰€åˆ†æçš„åŸå§‹ç¢¼æ˜¯èˆŠç‰ˆ(5.5)çš„ laravelï¼Œä½†å› ç‚ºæœ¬æ–‡ä¸»è¦æ¢è¨ IoC åœ¨ç‰¹å®š method çš„ä¾è³´è§£æï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯ä¸è®Šçš„ï¼Œä½†å¯èƒ½ä¸åŒç‰ˆæœ¬åœ¨éƒ¨åˆ†ç¨‹å¼ç¢¼ä¸Šé¢æœƒæœ‰äº›è¨±å·®ç•°</aside><p>ç†Ÿæ‚‰ Laravel çš„äººæ‡‰è©²éƒ½æ›‰å¾— IoC Container çš„å¼·å¤§ä¹‹è™•ï¼Œåœ¨ laravel ç•¶ä¸­ï¼Œå¯ä»¥ç°¡å–®åœ°é€éä¸€è¡Œ</p><p><code>app(MyClass::class)</code> å–å¾—å·²ç¶“è¢«æ³¨å…¥ä¾è³´å¾Œ Class çš„å¯¦ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dependence1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"foo"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dependence2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"foo2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $dep1;</span><br><span class="line">    <span class="keyword">private</span> $dep2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        Dependence1 $dependence1,</span></span></span><br><span class="line"><span class="function"><span class="params">        Dependence2 $dependence2</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dep1 = $dependence1;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dep2 = $dependence2;       </span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app(MyClass::class); <span class="comment">// maybe $this-&gt;app-&gt;make(MyClass::class) in ServiceProvider</span></span><br></pre></td></tr></table></figure><p>é€™æ˜¯ä¸€å€‹ laravel å¯¦ç¾æ§åˆ¶åè½‰(IoC)çš„ç°¡å–®ä¾‹å­ ï¼ŒMyClass çš„å»ºæ§‹å­ç•¶ä¸­çš„å…©å€‹å¼•æ•¸(ä¾è³´çš„Class) è¢« container è®€å–åˆ°å¾Œï¼Œå…ˆåˆ†åˆ¥è¢«å¯¦ä¾‹åŒ–ä¸¦ä½œç‚ºåƒæ•¸å‚³é€² MyClass çš„å»ºæ§‹å­ï¼Œæœ€å¾Œè¿”å›å¯¦ä¾‹åŒ–å®Œæˆçš„ MyClass ç‰©ä»¶ã€‚(æ¯æ¬¡æ‹œè®€åˆ°é€™é‚ŠçœŸçš„æ˜¯æƒ³è·ª laravel ä½œè€…ï¼‰</p><p>laravel ç•¶ä¸­è¨±å¤šåŸºç¤æ ¸å¿ƒçš„ Class åœ¨åº•å±¤ä¹Ÿæ˜¯é€™éº¼é‹ä½œçš„ï¼Œä¾‹å¦‚ Controller ä¹Ÿæ˜¯ç¶“ç”± IoC Container å¯¦ä¾‹åŒ–ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰èƒ½å¤ åœ¨ Controller å»ºæ§‹å­è£¡é¢å¯«ä¸€å †ä¾è³´ç‰©ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"> <span class="keyword">protected</span> $logger;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Logger $logger)</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line"> <span class="keyword">$this</span>-&gt;logger = $logger;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;logger-&gt;error(<span class="string">'Something happened'</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œlaravel ä¸åªæœƒè‡ªå‹•è§£æåœ¨å»ºæ§‹å­å¼•æ•¸ç•¶ä¸­çš„ Dependenciesï¼Œåœ¨æŸäº›ç‰¹å®š Class ç•¶ä¸­ï¼Œlaravel ä¹Ÿæœƒè‡ªå‹•è§£æ method å¼•æ•¸ä¸­çš„ä¾è³´ï¼Œæœ€å¸¸è¦‹çš„çš„å°±æ˜¯æˆ‘å€‘çš„ Controller</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">(Logger $logger, $id)</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">    $logger-&gt;error(<span class="string">'Something happened'</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°åº•å…¶èƒŒå¾Œæ˜¯æ€éº¼å¯¦ç¾é€™å€‹åŠŸèƒ½çš„å‘¢ï¼Ÿä»¥ä¸‹å°±é–‹å§‹ trace code ä¾†çœ‹çœ‹å§ã€‚</p><p>é¦–å…ˆï¼Œä¸€å€‹ Request çš„æ—…ç¨‹å°±æ˜¯å¾ <code>Illuminate\Contracts\Http\Kernel</code> é–‹å§‹ï¼Œ åœ¨ index.php ç•¶ä¸­ï¼Œå¯¦ä¾‹åŒ– Kernel Class ä¹‹å¾Œï¼Œ å‘¼å«äº† handle é€™å€‹ methodï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// public/index.php</span></span><br><span class="line">$kernel = $app-&gt;make(Illuminate\Contracts\Http\Kernel::class);</span><br><span class="line"></span><br><span class="line">$response = $kernel-&gt;handle(</span><br><span class="line">    $request = Illuminate\Http\Request::capture()</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ bootstrap/app.php ç•¶ä¸­æ‰¾åˆ°è©²æŠ½è±¡å°æ‡‰çš„ç¶å®šï¼Œä¹Ÿå°±æ˜¯ <code>App\Http\Kernel</code> ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bootstrap/app.php </span></span><br><span class="line">$app-&gt;singleton(</span><br><span class="line">    Illuminate\Contracts\Http\Kernel::class,</span><br><span class="line">    App\Http\Kernel::class</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ¥è‘—ï¼Œ <code>App\Http\Kernel</code> åˆ extend äº† <code>Illuminate\Foundation\Http\Kernel</code> ï¼Œhandle æ–¹æ³•å°±åœ¨é€™å€‹ Class ç•¶ä¸­å®šç¾©ï¼Œé‡é»æ˜¯ sendRequestThroughRouter é€™å€‹ methodï¼Œæº–å‚™è¦å°‡ Request åˆ†é…çµ¦ Router (ä¸Šé¢éƒ½é‚„åœ¨ application å±¤ï¼Œå¾é€™é‚Šé–‹å§‹é€²åˆ° framework è£¡é¢)ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">($request)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $request-&gt;enableHttpMethodParameterOverride();</span><br><span class="line"></span><br><span class="line">            $response = <span class="keyword">$this</span>-&gt;sendRequestThroughRouter($request);</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">sendRequestThroughRouter</span><span class="params">($request)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> Pipeline(<span class="keyword">$this</span>-&gt;app))</span><br><span class="line">                    -&gt;send($request)</span><br><span class="line">                    -&gt;through(<span class="keyword">$this</span>-&gt;app-&gt;shouldSkipMiddleware() ? [] : <span class="keyword">$this</span>-&gt;middleware)</span><br><span class="line">                    -&gt;then(<span class="keyword">$this</span>-&gt;dispatchToRouter()); <span class="comment">// å°‡ Request åˆ†é…çµ¦ Router</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">dispatchToRouter</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">($request)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;app-&gt;instance(<span class="string">'request'</span>, $request);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;router-&gt;dispatch($request);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹ä¾†è¦é€²å…¥åˆ° Router çš„éšæ®µï¼Œæœ‰äº›ä¸æ˜¯å¾ˆç›¸é—œçš„éƒ¨åˆ†å°±ç›´æ¥è·³éä¸è²¼ç¨‹å¼ç¢¼äº†ï¼Œé€²åˆ° Router å¾Œçš„ method å‘¼å«é †åºæ˜¯ dispatch  â†’ dispatchToRoute â†’ runRoute -&gt; runRouteWithinStack</p><p>ä¾†çœ‹ä¸€ä¸‹ åœ¨ runRouteWithinStack ç•¶ä¸­å€’æ•¸ç¬¬ä¸‰è¡Œ <code>$route-&gt;run()</code> ï¼Œé€™è£¡å³å°‡è¦æº–å‚™è§£æåœ¨ routes/xxx.php ç•¶ä¸­æ‰€å®šç¾©çš„ Route æ‰€æŒ‡å®šçš„å°æ‡‰ Controller ä»¥åŠ Controller method</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Routing/Router.php</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">runRouteWithinStack</span><span class="params">(Route $route, Request $request)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> Pipeline(<span class="keyword">$this</span>-&gt;container))</span><br><span class="line">                        -&gt;send($request)</span><br><span class="line">                        -&gt;through($middleware)</span><br><span class="line">                        -&gt;then(<span class="function"><span class="keyword">function</span> <span class="params">($request)</span> <span class="title">use</span> <span class="params">($route)</span> </span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;prepareResponse(</span><br><span class="line">                                $request, $route-&gt;run()</span><br><span class="line">                            );</span><br><span class="line">                        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é€™é‚Šé€²å…¥äº† Routeï¼Œä¸»è¦åœ¨æº–å‚™åŸ·è¡Œ Route æŒ‡å®šå°æ‡‰çš„ Controller ä»¥åŠ Controller methodï¼Œé€²åˆ° <code>$this-&gt;runController()</code> çš„éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Routing/Route.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;container = <span class="keyword">$this</span>-&gt;container ?: <span class="keyword">new</span> Container;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;isControllerAction()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;runController(); <span class="comment">// !!!</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;runCallable();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (HttpResponseException $e) &#123;</span><br><span class="line">            <span class="keyword">return</span> $e-&gt;getResponse();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é€™è£¡æœƒå‘¼å«åˆ° ControllerDispatcher çš„ dispatch æ–¹æ³•æ¥æ‰‹è™•ç†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Routing/Route.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">runController</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;controllerDispatcher()-&gt;dispatch(</span><br><span class="line">            <span class="keyword">$this</span>, <span class="keyword">$this</span>-&gt;getController(), <span class="keyword">$this</span>-&gt;getControllerMethod()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æŒ–äº†é€™éº¼æ·±ï¼Œçµ‚æ–¼è¦åˆ°é‡é ­æˆ²äº†ï¼Œä¹Ÿå°±æ˜¯å‘¼å«äº† <code>$this-&gt;resolveClassMethodDependencies</code> é€™å€‹ methodï¼Œä¸¦å°‡è·¯ç”±ä¸Šé¢æ‰€å¸¶çš„åƒæ•¸ã€å·²å¯¦ä¾‹åŒ–å¾Œçš„ Controller ä»¥åŠ method åç¨±åšç‚ºåƒæ•¸å‚³å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span><span class="params">(Route $route, $controller, $method)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $parameters = <span class="keyword">$this</span>-&gt;resolveClassMethodDependencies(</span><br><span class="line">            $route-&gt;parametersWithoutNulls(), $controller, $method</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> $controller-&gt;&#123;$method&#125;(...array_values($parameters));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>resolveClassMethodDependencies  å‘¼å«äº† resolveMethodDependenciesï¼Œä¸¦å°‡å‰›å‰›çš„è·¯ç”±åƒæ•¸ä»¥åŠä¸€å€‹æ–°çš„ ReflectionMethod å¯¦ä¾‹åšç‚ºåƒæ•¸å‚³å…¥ï¼ŒåŸä¾†å¯¦ç¾ Method Dependency injection çš„é‡è¦åŠŸè‡£å°±æ˜¯ ReflectionMethod é€™å€‹æ±è¥¿ï¼Œè—‰ç”± ReflectionMethodï¼Œæˆ‘å€‘å¯ä»¥ç²å¾—æŸå€‹ instance è£¡é¢é—œæ–¼æŸå€‹ method çš„è³‡è¨Šï¼ŒåŒ…æ‹¬<strong>å¯ä»¥çŸ¥é“ä»–æœ‰å“ªäº›å¼•æ•¸</strong>ï¼Œè€Œé€™ä¹Ÿå°±æ˜¯å¦‚ä½•å¾—ä»¥åµæ¸¬åˆ°é€™äº› method éœ€è¦çš„ä¾è³´ï¼Œä¸¦ä¸”é å…ˆè§£æå¥½ç‰©ä»¶ç•¶çœŸæ­£è¦å‘¼å«é€™å€‹ method æ™‚å†å°‡å·²è§£æå¥½çš„ç‰©ä»¶å¸¶å…¥çš„é—œéµ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveClassMethodDependencies</span><span class="params">(array $parameters, $instance, $method)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (! method_exists($instance, $method)) &#123;</span><br><span class="line">            <span class="keyword">return</span> $parameters;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resolveMethodDependencies(</span><br><span class="line">            $parameters, <span class="keyword">new</span> ReflectionMethod($instance, $method)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å€‘ä¾†çœ‹çœ‹ resolveMethodDependencies è£¡é¢åšäº†ä»€éº¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveMethodDependencies</span><span class="params">(array $parameters, ReflectionFunctionAbstract $reflector)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $instanceCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        $values = array_values($parameters);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($reflector-&gt;getParameters() <span class="keyword">as</span> $key =&gt; $parameter) &#123;</span><br><span class="line">            $instance = <span class="keyword">$this</span>-&gt;transformDependency(</span><br><span class="line">                $parameter, $parameters</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (! is_null($instance)) &#123;</span><br><span class="line">                $instanceCount++;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">$this</span>-&gt;spliceIntoParameters($parameters, $key, $instance);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (! <span class="keyword">isset</span>($values[$key - $instanceCount]) &amp;&amp;</span><br><span class="line">                      $parameter-&gt;isDefaultValueAvailable()) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">$this</span>-&gt;spliceIntoParameters($parameters, $key, $parameter-&gt;getDefaultValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $parameters;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå‚³å…¥çš„ parameters ç•¶ä¸­å¯èƒ½åŒ…å« primitive å€¼ï¼Œå› ç‚ºåœ¨ Route ç•¶ä¸­å¯èƒ½æœƒé€™æ¨£å®šç¾©ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in routes</span></span><br><span class="line">Route::get(<span class="string">'countries.&#123;country&#125;'</span>, <span class="string">'CountryController@show'</span>)-&gt;name(<span class="string">'countries.show'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Controllers</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">($country, Request $request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥ endpoint ç‚º <code>/api/countries/1</code> ï¼Œæˆ‘å€‘å°‡ <code>$parameters</code> ã€ <code>$reflector-&gt;getParameters()</code> dd å‡ºä¾†çœ‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// $parameters</span></span><br><span class="line"><span class="keyword">array</span>:<span class="number">1</span> [</span><br><span class="line">  <span class="string">"country"</span> =&gt; <span class="string">"1"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// $reflector-&gt;getParameters()</span></span><br><span class="line"><span class="keyword">array</span>:<span class="number">2</span> [</span><br><span class="line">  <span class="number">0</span> =&gt; ReflectionParameter &#123;<span class="comment">#1228</span></span><br><span class="line">    +name: <span class="string">"country"</span></span><br><span class="line">    position: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">1</span> =&gt; ReflectionParameter &#123;<span class="comment">#1229</span></span><br><span class="line">    +name: <span class="string">"request"</span></span><br><span class="line">    position: <span class="number">1</span></span><br><span class="line">    typeHint: <span class="string">"Illuminate\Http\Request"</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¦‚æœå¼•æ•¸æ˜¯æœ‰ typeHint ä¸¦å¯ä»¥è¢«å¯¦ä¾‹åŒ–ï¼Œå°±å°‡å®Œæˆè§£æçš„å¯¦ä¾‹æŒ‰ç…§æ­£ç¢ºä½ç½®å¡å…¥åŸå§‹çš„ $parameters ç•¶ä¸­ï¼Œæœ€å¾Œå›å‚³è©² $parameters é™£åˆ—çµ¦vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher@dispatch</p><p>å°‡é€™äº›è§£æå®Œç•¢çš„ä¾è³´åƒæ•¸å‚³å…¥ç›¸å°æ‡‰çš„ Controller method åŸ·è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$controller-&gt;&#123;$method&#125;(...array_values($parameters));</span><br></pre></td></tr></table></figure><p>æœ€å¾Œç•¶ç„¶å°±æ˜¯ call stack ä¸€å€‹ä¸€å€‹è¿”å›ï¼Œé€™é‚Šå°±ä¸è´…è¿°äº†ï¼Œä½†è‡³æ­¤å·²ç¶“å°‡ laravel å¯¦ç¾ Controller  method è‡ªå‹•æ³¨å…¥ä¾è³´çš„æ ¸å¿ƒéƒ¨åˆ†çˆ¬å®Œäº†ï¼Œæ”¶å·¥ï¼</p><h2 id="åƒè€ƒè³‡æ–™"><a href="#åƒè€ƒè³‡æ–™" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h2><ul><li>Laravel: Up &amp; Running (Book)</li><li><a href="https://www.php.net/manual/en/class.reflectionmethod.php" target="_blank" rel="noopener">https://www.php.net/manual/en/class.reflectionmethod.php</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;aside&gt;
ğŸ’¡ ç”±æ–¼ä»¥ä¸‹æ‰€åˆ†æçš„åŸå§‹ç¢¼æ˜¯èˆŠç‰ˆ(5.5)çš„ laravelï¼Œä½†å› ç‚ºæœ¬æ–‡ä¸»è¦æ¢è¨ IoC åœ¨ç‰¹å®š method çš„ä¾è³´è§£æï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯ä¸è®Šçš„ï¼Œä½†å¯èƒ½ä¸åŒç‰ˆæœ¬åœ¨éƒ¨åˆ†ç¨‹å¼ç¢¼ä¸Šé¢æœƒæœ‰äº›è¨±å·®ç•°

&lt;/aside&gt;

&lt;p&gt;ç†Ÿæ‚‰ Laravel çš„äººæ‡‰è©²éƒ½æ›‰å¾— IoC C
      
    
    </summary>
    
      <category term="Laravel" scheme="https://linxinemily.github.io/categories/Laravel/"/>
    
    
  </entry>
  
  <entry>
    <title>Promise.all() èˆ‡ async/awaitï¼ˆå’Œ axiosï¼‰</title>
    <link href="https://linxinemily.github.io/2019/06/30/Promise-all%E8%88%87async-await%EF%BC%88%E5%92%8Caxios%EF%BC%89/"/>
    <id>https://linxinemily.github.io/2019/06/30/Promise-allèˆ‡async-awaitï¼ˆå’Œaxiosï¼‰/</id>
    <published>2019-06-30T06:48:12.000Z</published>
    <updated>2019-06-30T14:10:24.278Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ä¾†ä¸€ç›´éƒ½ç”¨è¿´åœˆå»è™•ç†åŒæ™‚ç™¼å¤šå€‹ requestï¼ˆå¾ˆå¥½æ‡‚ä½†æœ‰é»é›£è™•ç† Errorï¼‰ï¼Œé€™æ¬¡è¦ªè‡ªä¾†è©¦è©¦ Promise.all() ç¸½ç®—é«”é©—åˆ°å¹³è¡Œè™•ç†éåŒæ­¥çš„å¨åŠ›ï¼ˆï¼Ÿï¼‰æ–¼æ˜¯ç´€éŒ„ä¸€ä¸‹å¿ƒå¾—ä»¥åŠå’Œ await + axios é€£ç”¨æ™‚çš„ä¸€äº›çœ‰è§’ã€‚</p><a id="more"></a><h2 id="Promise-all-ç”¨æ³•"><a href="#Promise-all-ç”¨æ³•" class="headerlink" title="Promise.all() ç”¨æ³•"></a>Promise.all() ç”¨æ³•</h2><p>Promise.all (<code>iterable</code>) æ¥å—ä¸€å€‹ iterable ç‰©ä»¶ï¼ˆé€šå¸¸æ˜¯é™£åˆ—ï¼‰ä½œç‚ºåƒæ•¸ï¼Œç•¶è£¡é¢æ¯å€‹å…ƒç´ éƒ½æ˜¯ Promise ç‰©ä»¶æ™‚(ä¹Ÿå¯ä»¥ä¸æ˜¯ï¼Œå¾…æœƒæœƒæåˆ°ï¼‰ï¼Œå®ƒå°±æœƒå¹³è¡Œå»è™•ç†é€™äº› Promiseã€‚ç”±æ–¼<strong>å…¶æœ¬èº«æœƒå›å‚³ä¸€å€‹ Promise ç‰©ä»¶</strong>ï¼Œæ‰€ä»¥æˆ‘å€‘åŒæ¨£å¯ä»¥ç”¨ then æˆ– await å»æ¥ä»–çš„ resolve/rejectã€‚<br>ç•¶æ‰€æœ‰çš„ Promise éƒ½è¢« resolve å¾Œæ‰æœƒå›å‚³ resolveï¼Œå…¶å€¼æœƒæ˜¯å…¨éƒ¨çš„ Promise è™•ç†å®Œå¾Œæ‰€å›å‚³çš„ resolve å€¼æ‰€çµ„æˆçš„é™£åˆ—ã€‚ä½†è‹¥å…¶ä¸­æœ‰ä¸€å€‹ Promise è¢« reject å°±æœƒç›´æ¥æ‹‹å‡ºè©² Promise æ‰€å›å‚³çš„éŒ¯èª¤ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> array1 = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>];</span><br><span class="line"><span class="keyword">const</span> promiseArr = array1.map(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">Promise</span>.resolve(x));</span><br><span class="line"><span class="built_in">console</span>.log(promiseArr) <span class="comment">//Â [Promise, Promise, Promise, Promise]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨ then æ¥çµæœ</span></span><br><span class="line"><span class="built_in">Promise</span>.all(promiseArr).then(<span class="function"><span class="params">vals</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(vals) <span class="comment">// [1, 4, 9, 16]</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ç”¨ await æ¥çµæœ</span></span><br><span class="line"><span class="keyword">const</span> vals = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(promiseArr)</span><br><span class="line"><span class="built_in">console</span>.log(vals) <span class="comment">// [1, 4, 9, 16]</span></span><br></pre></td></tr></table></figure><blockquote><p>æé†’ï¼š <code>await</code> å¾Œé¢æ¥çš„ä¸€å®šæœƒæ˜¯ä¸€å€‹  Promise ï¼ˆæˆ– async functionï¼‰ï¼Œä»–æœƒå¹«æˆ‘å€‘æŠŠ Promise è™•ç†å®Œå¾Œç›´æ¥åçµ¦æˆ‘å€‘ resovle æˆ– reject çš„å€¼ã€‚</p></blockquote><p>è€Œç•¶é™£åˆ—è£¡é¢æœ‰é Promise ç‰©ä»¶çš„å…ƒç´ å­˜åœ¨æ™‚ï¼ŒPromise.all() ä»æœƒè¼¸å‡ºè©²å…ƒç´ çš„å€¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">Promise</span>.resolve(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> result = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([a, b])</span><br><span class="line"><span class="built_in">console</span>.log(result) <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure><h2 id="Promise-all-axios"><a href="#Promise-all-axios" class="headerlink" title="Promise.all() + axios"></a>Promise.all() + axios</h2><p>æˆ‘å€‘å¯ä»¥å…ˆé€é <code>map()</code> è™•ç†åŸå§‹é™£åˆ—ï¼ˆ<code>map()</code>æœƒå›å‚³æ–°çš„é™£åˆ—ï¼‰ï¼ŒæŠŠåŸå§‹é™£åˆ—æ”¹æˆä¸€çµ„ Promise é™£åˆ—ã€‚ä»¥ä¸‹é¢ç¨‹å¼ç¢¼ç‚ºä¾‹ï¼Œ products ç‚ºä¸€çµ„å•†å“ç‰©ä»¶çš„é™£åˆ—ï¼Œåœ¨æ­¤å³åˆ©ç”¨ <code>map ()</code> éæ­·æ¯å€‹å•†å“ç‰©ä»¶ï¼Œåœ¨ <code>map()</code> çš„ callback function è£¡ç›´æ¥å‘¼å« axios å°‡å•†å“è³‡è¨Šå¸¶å…¥ request body ç™¼é€è«‹æ±‚ï¼Œç”±æ–¼ axios æœ¬èº«å°±æœƒå›å‚³ Promiseï¼Œæ‰€ä»¥æˆ‘å€‘å°±èƒ½æˆåŠŸæ‹¿åˆ°ä¸€çµ„ Promise é™£åˆ—ä¸¦ç›´æ¥å¡é€² Promise.all è£¡é¢å›‰ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(<span class="keyword">this</span>.products.map(<span class="function">(<span class="params">product</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$axios.post(<span class="string">'http://localhost:8000/api/products'</span>, &#123;</span><br><span class="line">    name: product.name,</span><br><span class="line">    price: product.price,</span><br><span class="line">    order_id: myOrder_id</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;))</span><br><span class="line"><span class="built_in">console</span>.log(data)</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘å€‘æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—é•·é€™æ¨£ï¼š</p><p><img src="/images/image.png" alt="åœ–ç‰‡"></p><p>é€™æ™‚ç™¼ç¾å®ƒé•·å¾—å¥½åƒä¸æ˜¯æˆ‘å€‘è¦çš„ response dataï¼Œé‚£æ˜¯å› ç‚º axios çš„ response ï¼ˆresolve valueï¼‰ä¸¦éç›´æ¥å› server çµ¦æˆ‘å€‘çš„è³‡æ–™ ï¼Œè€Œè£¡é¢é‚£å±¤ data æ‰æ˜¯æˆ‘å€‘è¦çš„è³‡æ–™ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  data: &#123;&#125;, <span class="comment">//é€™æ‰æ˜¯ server å›çµ¦æˆ‘å€‘çš„è³‡æ–™</span></span><br><span class="line">  status: <span class="number">200</span>,</span><br><span class="line">  statusText: <span class="string">'OK'</span>,</span><br><span class="line">  headers: &#123;&#125;,</span><br><span class="line">  config: &#123;&#125;,</span><br><span class="line">  request: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬ä¾†ä¸€ç›´éƒ½ç”¨è¿´åœˆå»è™•ç†åŒæ™‚ç™¼å¤šå€‹ requestï¼ˆå¾ˆå¥½æ‡‚ä½†æœ‰é»é›£è™•ç† Errorï¼‰ï¼Œé€™æ¬¡è¦ªè‡ªä¾†è©¦è©¦ Promise.all() ç¸½ç®—é«”é©—åˆ°å¹³è¡Œè™•ç†éåŒæ­¥çš„å¨åŠ›ï¼ˆï¼Ÿï¼‰æ–¼æ˜¯ç´€éŒ„ä¸€ä¸‹å¿ƒå¾—ä»¥åŠå’Œ await + axios é€£ç”¨æ™‚çš„ä¸€äº›çœ‰è§’ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Javascript" scheme="https://linxinemily.github.io/categories/Javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>Vue $attrs/$listeners çˆºå­«çµ„ä»¶è³‡æ–™å‚³é</title>
    <link href="https://linxinemily.github.io/2019/06/23/Vue%E7%88%BA%E5%AD%AB%E7%B5%84%E4%BB%B6%E8%B3%87%E6%96%99%E5%82%B3%E9%81%9E/"/>
    <id>https://linxinemily.github.io/2019/06/23/Vueçˆºå­«çµ„ä»¶è³‡æ–™å‚³é/</id>
    <published>2019-06-23T14:38:02.000Z</published>
    <updated>2019-06-30T07:45:08.863Z</updated>
    
    <content type="html"><![CDATA[<p>å¹³å¸¸åœ¨å¯¦ä½œ Vue çµ„ä»¶ä¹‹é–“çš„è³‡æ–™å‚³éå¤§éƒ¨åˆ†éƒ½æ˜¯é€é <code>props</code> åŠ <code>$emit</code>ï¼Œæˆ–æ˜¯ç›´æ¥ç¶“ç”± Vuex é€²è¡Œç‹€æ…‹ç®¡ç†ï¼Œè€Œé™¤äº†é€™å…©ç¨®æ–¹æ³•ï¼Œé‚„æœ‰å¦å¤–ä¸€ç¨®åšæ³•æ˜¯é€é <code>$attrs</code> åŠ <code>$listenter</code>ã€‚</p><a id="more"></a><p>æœ¬èº«ä¹Ÿæ˜¯å› ç‚ºä¹‹å‰å¶ç„¶åœ¨æŸ¥è³‡æ–™çš„æ™‚å€™çœ‹åˆ°é€™å…©å€‹ APIï¼Œä½†ç•¶æ™‚çœ‹éåˆ¥äººå¯«çš„æ–‡ç« å¾Œå»åªæ˜¯ä¼¼æ‡‚éæ‡‚ï¼Œé ‚å¤šçŸ¥é“æœ‰é€™å€‹æ±è¥¿ä½†ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨æˆ–è©²ç”¨åœ¨ä»€éº¼å ´åˆï¼Œä¸€ç›´åˆ°å¯¦ä½œæ™‚æ‰çœŸæ­£ç†è§£å®ƒçš„ç”¨æ³•ï¼Œä½†å¤šçœ‹å¤šè®€ç¸½æ˜¯å¥½çš„ï¼Œæœ‰ä¸€å¤©æˆ–è¨±æ´¾å¾—ä¸Šç”¨å ´ã€‚</p><h2 id="attrs"><a href="#attrs" class="headerlink" title="$attrs"></a><code>$attrs</code></h2><p>å…¶å¯¦ç°¡å–®èªªå°±æ˜¯å­çµ„ä»¶å¯ä»¥é€é<code>$attrs</code>å–å¾—çˆ¶çµ„ä»¶ç•¶ä¸­<em>é™¤äº† Props ä»¥å¤–</em>çš„æ‰€æœ‰è³‡æ–™ã€‚</p><p>ä¹çœ‹ä¹‹ä¸‹å¥½åƒæ²’ä»€éº¼ï¼Œé‚£ä¸å°±ç›´æ¥ç”¨ Props å°±å¥½äº†å—ï¼Ÿ<br>ä½†ç•¶åœ¨å¤šé‡çµ„ä»¶åµŒå¥—çš„æƒ…æ³ä¹‹ä¸‹ï¼Œå°±æœƒé¡¯å¾—å¾ˆæœ‰ç”¨ã€‚æˆ‘å€‘å…ˆå®šç¾©å‡ºä¸‰å€‹çµ„ä»¶ï¼Œä»–å€‘åˆ†åˆ¥æ˜¯ï¼š a-componentï¼ˆçˆºçµ„ä»¶/æ¨¡æ¿ï¼‰ã€b-componentï¼ˆçˆ¶çµ„ä»¶ï¼‰ã€c-componentï¼ˆå­«çµ„ä»¶ï¼‰</p><p>æˆ‘å€‘å¯ä»¥åœ¨ a ä½¿ç”¨ bï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// a-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b-component</span> <span class="attr">:msg</span>=<span class="string">"hello"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥è‘—åœ¨ b ä¸­æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>$attrs</code> è€Œä¸ç”¨é€é Props æ‹¿åˆ° <code>apiUrl</code>ï¼Œä¸¦ä¸”å°‡ <code>$attrs</code> é€é <code>v-bind</code> ç¶å®šåœ¨ c ä¸Šå‚³çµ¦ c ä½¿ç”¨ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// b-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; $attrs.data &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c-component</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶å¾ŒåŒæ¨£åœ¨ c ç•¶ä¸­æˆ‘å€‘å°±èƒ½å¤ é€é<code>$attrs</code>å–å¾— a çš„è³‡æ–™ ã€‚é€™æ¨£ä¸€ä¾†çš„å¥½è™•å°±æ˜¯ç•¶æˆ‘å€‘æœ‰å¤šå€‹è³‡æ–™è¦å¾ a å‚³çµ¦ b è·Ÿ c å…±ç”¨æ™‚ï¼Œä¸ç”¨æ¯ä¸€å±¤éƒ½è¦è²æ˜ Propsï¼Œç„¶å¾Œé‚„è¦å°‡æ¯å€‹ Props å¯«åœ¨ component çš„æ¨™ç±¤è£¡é¢ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// c-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; $attrs.data &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å’Œ <code>$attrs</code> ç›¸é—œçš„ API é‚„æœ‰ <code>inheritAttrs</code>ï¼Œå…¶å€¼ç‚ºå¸ƒæ—å€¼ï¼Œé è¨­ç‚º <code>true</code>ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæˆ‘å€‘æ²’æœ‰ç‰¹åˆ¥å°‡å…¶è¨­å®šæˆ <code>false</code>ï¼Œå­çµ„ä»¶é»˜èªå¯ä»¥é€é <code>$attrs</code> å–å¾—åœ¨çˆ¶çµ„ä»¶ç•¶ä¸­éé€é Props ç¹¼æ‰¿çš„è³‡æ–™ã€‚</p></blockquote><h2 id="listeners"><a href="#listeners" class="headerlink" title="$listeners"></a>$listeners</h2><p>æ‡‰è©²ä¸é›£çŒœæƒ³ï¼Œ <code>$attrs</code>  å°æ‡‰ Props ï¼Œ<code>$listeners</code> å‰‡å°æ‡‰ <code>$emit</code>ã€‚ç°¡å–®ä¾†èªªå°±æ˜¯çˆ¶çµ„ä»¶å¯ä»¥é€é <code>$listeners</code> å–å¾—æ‰€æœ‰å­çµ„ä»¶ <code>$emit</code> æ‰“å‡ºä¾†çš„äº‹ä»¶ã€‚åŒæ¨£ä»¥ä¸Šé¢ä¸‰å€‹çµ„ä»¶ç‚ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// c-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$emit('sayHi')"</span>&gt;</span> click me!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ b ç•¶ä¸­åŒæ¨£å¯ä»¥é€é <code>v-on=&quot;$listeners&quot;</code>å°‡ c äº‹ä»¶å§”ä»»çµ¦ aï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// b-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c-component</span> <span class="attr">v-on</span>=<span class="string">"$listeners"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>a å°±å¯ä»¥ç›´æ¥è™•ç† c æ‰“å‡ºçš„<code>$emit</code>äº‹ä»¶ï¼Œè€Œä¸ç”¨é€é b å† emit ä¸€æ¬¡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// a-component</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b-component</span> @<span class="attr">sayHi</span>=<span class="string">"anEventHandler"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h2><p>æ‰€ä»¥ç•¶å¤šé‡çµ„ä»¶ä¹‹é–“éœ€è¦æºé€šå‚³éï¼Œä½†ä¸æƒ³ç”¨ Vuex æ™‚ï¼Œå¯ä»¥å˜—è©¦æ¡ç”¨é€™å…©ç¨®æ–¹æ³•ï¼š<br>    * <code>$attrs</code>ï¼šå­«çµ„ä»¶å–å¾—çˆºçµ„ä»¶çš„è³‡æ–™<br>    * <code>$listeners</code>ï¼šçˆºçµ„ä»¶ç›´æ¥è§¸ç™¼å­«çµ„ä»¶çš„äº‹ä»¶</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¹³å¸¸åœ¨å¯¦ä½œ Vue çµ„ä»¶ä¹‹é–“çš„è³‡æ–™å‚³éå¤§éƒ¨åˆ†éƒ½æ˜¯é€é &lt;code&gt;props&lt;/code&gt; åŠ &lt;code&gt;$emit&lt;/code&gt;ï¼Œæˆ–æ˜¯ç›´æ¥ç¶“ç”± Vuex é€²è¡Œç‹€æ…‹ç®¡ç†ï¼Œè€Œé™¤äº†é€™å…©ç¨®æ–¹æ³•ï¼Œé‚„æœ‰å¦å¤–ä¸€ç¨®åšæ³•æ˜¯é€é &lt;code&gt;$attrs&lt;/code&gt; åŠ &lt;code&gt;$listenter&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="https://linxinemily.github.io/categories/Vue/"/>
    
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ vue-echarts è¸©çš„å‘</title>
    <link href="https://linxinemily.github.io/2019/06/11/%E4%BD%BF%E7%94%A8vue-echarts%E8%B8%A9%E7%9A%84%E5%9D%91/"/>
    <id>https://linxinemily.github.io/2019/06/11/ä½¿ç”¨vue-echartsè¸©çš„å‘/</id>
    <published>2019-06-11T04:29:13.308Z</published>
    <updated>2019-06-30T06:43:38.098Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡ä½¿ç”¨ Echarts é€™å¥—åœ–å½¢ libraryï¼Œåœ¨ vue ä¸­ä½¿ç”¨ Echarts å¯ä»¥ç›´æ¥è£ vue-echartï¼Œå®˜æ–¹æ–‡ä»¶æ¨è–¦å…©å€‹éƒ½è£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install echarts vue-echarts</span><br></pre></td></tr></table></figure><p>é æ–™ä¹‹ä¸­çš„è¸©äº†ä¸å°‘å‘ï¼Œåœ¨æ­¤ç´€éŒ„ä¸€äº›é‡é»ã€‚</p><a id="more"></a><h2 id="å®‰è£å®Œå¾Œå¼•å…¥ä¸¦è¨»å†Šåœ–è¡¨-component"><a href="#å®‰è£å®Œå¾Œå¼•å…¥ä¸¦è¨»å†Šåœ–è¡¨-component" class="headerlink" title="å®‰è£å®Œå¾Œå¼•å…¥ä¸¦è¨»å†Šåœ–è¡¨ component"></a>å®‰è£å®Œå¾Œå¼•å…¥ä¸¦è¨»å†Šåœ–è¡¨ component</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> ECharts <span class="keyword">from</span> <span class="string">'vue-echarts'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'echarts/lib/chart/bar'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'echarts/lib/component/tooltip'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'echarts-gl'</span> <span class="comment">//ç­‰ç­‰æœƒä½¿ç”¨ grapic è¨­å®šåœ–å½¢æ–‡å­—ï¼Œæ•…éœ€è¼‰å…¥æ­¤ module</span></span><br><span class="line"></span><br><span class="line">Vue.component(<span class="string">'v-chart'</span>, ECharts) <span class="comment">// è¨»å†Šç‚º global component</span></span><br></pre></td></tr></table></figure><h2 id="åŸºç¤ä½¿ç”¨"><a href="#åŸºç¤ä½¿ç”¨" class="headerlink" title="åŸºç¤ä½¿ç”¨"></a>åŸºç¤ä½¿ç”¨</h2><p>åœ¨ template ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨åœ–è¡¨ componentï¼Œå…¶æ¥æ”¶ <code>options</code> ç‚º propsï¼Œè£¡é¢çš„<code>series</code>å±¬æ€§ç‚ºè¨­ç½®ç‰¹å®šé¡å‹åœ–è¡¨çš„å±¬æ€§ï¼Œåœ¨æ­¤ä½¿ç”¨å°ˆæ¡ˆä¸­çš„åœ“é¤…åœ–ç•¶ç¯„ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">v-chart</span> <span class="attr">:options</span>=<span class="string">"options"</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        options: &#123;</span><br><span class="line">            series: [</span><br><span class="line">                &#123;</span><br><span class="line">                    type: <span class="string">'pie'</span>,  <span class="comment">// å¿…é ˆ</span></span><br><span class="line">                    name: <span class="string">'test'</span>, <span class="comment">// å¿…é ˆ</span></span><br><span class="line">                    radius: [<span class="string">'50%'</span>, <span class="string">'70%'</span>],</span><br><span class="line">                    label: &#123;</span><br><span class="line">                    normal: &#123;</span><br><span class="line">                        show: <span class="literal">false</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    emphasis: &#123;</span><br><span class="line">                        show: <span class="literal">true</span>,</span><br><span class="line">                        formatter: <span class="string">'&#123;b&#125; &#123;@percentage&#125;%'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: [</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'éŸ“åœ‹'</span>, <span class="attr">value</span>: <span class="number">70</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'æ—¥æœ¬'</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'å°ç£'</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'è¶Šå—'</span>, <span class="attr">value</span>: <span class="number">6</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'ä¸­åœ‹'</span>, <span class="attr">value</span>: <span class="number">3</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">name</span>: <span class="string">'å…¶ä»–'</span>, <span class="attr">value</span>: <span class="number">1</span> &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åœ“é¤…åœ–ä¸­é–“åŠ å…¥æ–‡å­—"><a href="#åœ“é¤…åœ–ä¸­é–“åŠ å…¥æ–‡å­—" class="headerlink" title="åœ“é¤…åœ–ä¸­é–“åŠ å…¥æ–‡å­—"></a>åœ“é¤…åœ–ä¸­é–“åŠ å…¥æ–‡å­—</h2><blockquote><p>æ³¨æ„ï¼š<strong>ä¸€å®šè¦è£ <code>echarts-gl</code> æ¨¡çµ„</strong>ï¼Œå¦å‰‡æœƒç„¡æ³•é¡¯ç¤ºã€‚<br>å¯ä»¥ç›´æ¥åˆ©ç”¨å®˜æ–¹æä¾›çš„å±¬æ€§<code>grapic</code>ç‚ºåœ–è¡¨è‡ªè¡Œæ·»åŠ åœ–å½¢å…ƒç´ ï¼Œä¸¦æ–°å¢ç‰¹å®šæ–‡å­—ï¼ˆå¯ä»¥æ–°å¢çš„åœ–å½¢å…ƒç´ é¡å‹é‚„æœ‰åœ–ç‰‡ã€åœ–å½¢ç­‰ï¼Œå¯ä»¥åƒè€ƒ<a href="https://echarts.baidu.com/option.html#graphic" target="_blank" rel="noopener">æ–‡ä»¶</a>ï¼‰ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">graphic: [</span><br><span class="line">          &#123;</span><br><span class="line">            type: <span class="string">'text'</span>,</span><br><span class="line">            left: <span class="string">'center'</span>,</span><br><span class="line">            top: <span class="string">'center'</span>,</span><br><span class="line">            style: &#123;</span><br><span class="line">              text: <span class="string">'å­¸ç”Ÿåœ‹ç±æ¯”ä¾‹'</span>,</span><br><span class="line">              textAlign: <span class="string">'center'</span>,</span><br><span class="line">              fill: <span class="string">'#666'</span>,</span><br><span class="line">              font: <span class="string">'20px "STHeiti", sans-serif'</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br></pre></td></tr></table></figure><h2 id="åœ–ä¾‹èªªæ˜ï¼ˆlegendï¼‰éœ€è¦æ·»åŠ -value-è³‡æ–™"><a href="#åœ–ä¾‹èªªæ˜ï¼ˆlegendï¼‰éœ€è¦æ·»åŠ -value-è³‡æ–™" class="headerlink" title="åœ–ä¾‹èªªæ˜ï¼ˆlegendï¼‰éœ€è¦æ·»åŠ  value è³‡æ–™"></a>åœ–ä¾‹èªªæ˜ï¼ˆlegendï¼‰éœ€è¦æ·»åŠ  value è³‡æ–™</h2><p>echarts æä¾›çš„ formater callback function åªæœ‰çµ¦æˆ‘å€‘ <code>name</code> é€™å€‹åƒæ•¸ï¼Œæ‰€ä»¥è¦åŒæ™‚æ‹¿åˆ° <code>value</code> çš„è©±ï¼Œæœƒéœ€è¦è‡ªå·±å¾åœ–è¡¨å¯¦ä¾‹è£¡é¢æ‰¾ã€‚</p><blockquote><p>æ³¨æ„ï¼š<strong>å¿…é ˆä½¿ç”¨ç®­é ­å‡½å¼</strong>æ‰èƒ½æ‹¿åˆ°é€™å€‹ component çš„å¯¦ä¾‹ï¼Œé€²è€Œå–å¾— <code>options.series[0].data</code> å¾—åˆ°æˆ‘å€‘è¦çš„ <code>value</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">legend: &#123;</span><br><span class="line">          orient: <span class="string">'verticle'</span>,</span><br><span class="line">          left: <span class="string">'left'</span>,</span><br><span class="line">          bottom: <span class="string">'middle'</span>,</span><br><span class="line">          textStyle: &#123;</span><br><span class="line">            fontSize: <span class="number">16</span></span><br><span class="line">          &#125;,</span><br><span class="line">          formatter: <span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">this</span>.options.series[<span class="number">0</span>].data</span><br><span class="line">            <span class="keyword">let</span> targetValue</span><br><span class="line">            data.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (item.name === name) &#123;</span><br><span class="line">                targetValue = item.value</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span> name + <span class="string">' '</span> + targetValue + <span class="string">'%'</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure><h2 id="åœ–è¡¨çš„éŸ¿æ‡‰"><a href="#åœ–è¡¨çš„éŸ¿æ‡‰" class="headerlink" title="åœ–è¡¨çš„éŸ¿æ‡‰"></a>åœ–è¡¨çš„éŸ¿æ‡‰</h2><p>ç”±æ–¼ä¸€é–‹å§‹è¨­å®šåœ–ä¾‹çš„æ’åˆ—æ–¹å¼ç‚ºå‚ç›´æ’åˆ—ã€é å·¦ä¸¦ç½®ä¸­ï¼Œä½†åœ¨è¡Œå‹•è£ç½®ä¸Šé€™æ¨£æœƒç ´ç‰ˆï¼Œæ‰€ä»¥é¦–å…ˆç¬¬ä¸€æ­¥å…ˆè¨­å®šè®“æ•´å€‹ Canvas å¯ä»¥è‡ªé©æ‡‰å®¹å™¨å¤§å°ç¸®æ”¾ï¼Œå¯¦ç¾æ–¹æ³•å…¶å¯¦åªè¦ä¿®æ”¹ CSS å³å¯ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.echarts</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—å°±æœƒé¢è‡¨åˆ°åœ–ä¾‹è·Ÿåœ–è¡¨æœ¬é«”é‡ç–Šçš„å•é¡Œï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦åµæ¸¬è¦–çª—å¯¬åº¦å¤§å°ï¼Œéš¨è‘—è£ç½®å¯¬åº¦ä¸åŒæ”¹è®Šåœ–ä¾‹æ’åˆ—çš„æ–¹å¼ã€‚</p><h4 id="1-é¦–å…ˆå…ˆåœ¨-component-ä¸Šç¶å®š-ref"><a href="#1-é¦–å…ˆå…ˆåœ¨-component-ä¸Šç¶å®š-ref" class="headerlink" title="1. é¦–å…ˆå…ˆåœ¨ component ä¸Šç¶å®š ref"></a>1. é¦–å…ˆå…ˆåœ¨ component ä¸Šç¶å®š <code>ref</code></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">v-chart</span> <span class="attr">ref</span>=<span class="string">"myChart"</span> <span class="attr">:options</span>=<span class="string">"options"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-åœ¨-mounted-ç•¶ä¸­ç›£è½-window-çš„-load-eventï¼Œç•¶é é¢è¼‰å…¥æ™‚è¨ˆç®—ç•¶å‰è¢å¹•å¯¬åº¦å¤§å°ï¼Œå†é€é-ref-å±¬æ€§è¨ªå•è©²åœ–è¡¨å¯¦ä¾‹ä¸¦ä¿®æ”¹å…¶-options-legend-å±¬æ€§ï¼ˆå’Œåœ–ä¾‹å®šä½ç›¸é—œçš„å±¬æ€§ï¼‰"><a href="#2-åœ¨-mounted-ç•¶ä¸­ç›£è½-window-çš„-load-eventï¼Œç•¶é é¢è¼‰å…¥æ™‚è¨ˆç®—ç•¶å‰è¢å¹•å¯¬åº¦å¤§å°ï¼Œå†é€é-ref-å±¬æ€§è¨ªå•è©²åœ–è¡¨å¯¦ä¾‹ä¸¦ä¿®æ”¹å…¶-options-legend-å±¬æ€§ï¼ˆå’Œåœ–ä¾‹å®šä½ç›¸é—œçš„å±¬æ€§ï¼‰" class="headerlink" title="2. åœ¨ mounted ç•¶ä¸­ç›£è½ window çš„ load eventï¼Œç•¶é é¢è¼‰å…¥æ™‚è¨ˆç®—ç•¶å‰è¢å¹•å¯¬åº¦å¤§å°ï¼Œå†é€é ref å±¬æ€§è¨ªå•è©²åœ–è¡¨å¯¦ä¾‹ä¸¦ä¿®æ”¹å…¶ options.legend å±¬æ€§ï¼ˆå’Œåœ–ä¾‹å®šä½ç›¸é—œçš„å±¬æ€§ï¼‰"></a>2. åœ¨ mounted ç•¶ä¸­ç›£è½ window çš„ load eventï¼Œç•¶é é¢è¼‰å…¥æ™‚è¨ˆç®—ç•¶å‰è¢å¹•å¯¬åº¦å¤§å°ï¼Œå†é€é <code>ref</code> å±¬æ€§è¨ªå•è©²åœ–è¡¨å¯¦ä¾‹ä¸¦ä¿®æ”¹å…¶ <code>options.legend</code> å±¬æ€§ï¼ˆå’Œåœ–ä¾‹å®šä½ç›¸é—œçš„å±¬æ€§ï¼‰</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.windowWidth = <span class="built_in">window</span>.screen.width</span><br><span class="line">      <span class="keyword">let</span> orient, left, bottom</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.windowWidth &lt; <span class="number">480</span>) &#123;</span><br><span class="line">        orient = <span class="string">'horizontal'</span></span><br><span class="line">        left = <span class="string">'center'</span></span><br><span class="line">        bottom = <span class="string">'bottom'</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        orient = <span class="string">'vertical'</span></span><br><span class="line">        left = <span class="string">'left'</span></span><br><span class="line">        bottom = <span class="string">'middle'</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.$refs.myChart) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$refs.myChart.options.legend.orient = orient</span><br><span class="line">        <span class="keyword">this</span>.$refs.myChart.options.legend.left = left</span><br><span class="line">        <span class="keyword">this</span>.$refs.myChart.options.legend.bottom = bottom</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šæ­¤ç¶å®šæ–¹æ³•åªæœ‰åœ¨é é¢ç¬¬ä¸€æ¬¡æ¸²æŸ“æ™‚æ‰æœƒæœ‰æ•ˆï¼Œå¦‚æœè¦å¯¦ç¾ RWD è¦å†å¦å¤–ç›£è½ resize äº‹ä»¶ã€‚</p></blockquote><h2 id="çµèª"><a href="#çµèª" class="headerlink" title="çµèª"></a>çµèª</h2><h4 id="1-å¦‚æœè¦ç”¨åˆ°è¼ƒå¤šå®¢è£½åŒ–åŠŸèƒ½è¦ç”¨-Echartsï¼Œå¦å‰‡æ‰ç”¨-v-charts"><a href="#1-å¦‚æœè¦ç”¨åˆ°è¼ƒå¤šå®¢è£½åŒ–åŠŸèƒ½è¦ç”¨-Echartsï¼Œå¦å‰‡æ‰ç”¨-v-charts" class="headerlink" title="1. å¦‚æœè¦ç”¨åˆ°è¼ƒå¤šå®¢è£½åŒ–åŠŸèƒ½è¦ç”¨ Echartsï¼Œå¦å‰‡æ‰ç”¨ v-charts"></a>1. å¦‚æœè¦ç”¨åˆ°è¼ƒå¤šå®¢è£½åŒ–åŠŸèƒ½è¦ç”¨ Echartsï¼Œå¦å‰‡æ‰ç”¨ v-charts</h4><p>åœ¨åŠ å…¥åœ“é¤…ä¸­é–“æ–‡å­—é‚£è£¡å¡æ»¿ä¹…ï¼ŒåŸå› æ˜¯ä¸€é–‹å§‹è£çš„æ˜¯ v-chartsï¼ˆç®—æ˜¯è¼•é‡ç°¡åŒ–ç‰ˆçš„ Echartsï¼‰ï¼Œæ¨æ¸¬ç›®å‰é‚„æ²’æœ‰æ”¯æ´åˆ°å¯ä»¥ä½¿ç”¨åœ–å½¢æ–‡å­—ï¼ˆå„ç¨®æ–¹å¼åŠ å…¥ <code>graphic</code> å±¬æ€§éƒ½æœªèµ·ä½œç”¨ï¼‰ï¼Œé›–ç„¶ä¹Ÿå¯èƒ½åªæ˜¯å°šæœªæ‰¾åˆ°è§£æ±ºæ–¹æ¡ˆï¼ˆç¿»æ–‡ä»¶å¿«ç¿»åˆ°ç™¼ç˜‹ï¼‰ã€‚</p><h4 id="2-åœ¨-Vue-ç•¶ä¸­å–å¾—åœ–è¡¨å¯¦ä¾‹çš„æ–¹æ³•"><a href="#2-åœ¨-Vue-ç•¶ä¸­å–å¾—åœ–è¡¨å¯¦ä¾‹çš„æ–¹æ³•" class="headerlink" title="2. åœ¨ Vue ç•¶ä¸­å–å¾—åœ–è¡¨å¯¦ä¾‹çš„æ–¹æ³•"></a>2. åœ¨ Vue ç•¶ä¸­å–å¾—åœ–è¡¨å¯¦ä¾‹çš„æ–¹æ³•</h4><p>åœ¨ <code>options</code> å…§éƒ¨è‹¥ç”¨åˆ°å…¶æä¾›çš„å›èª¿å‡½å¼ï¼Œå¿…é ˆä½¿ç”¨ç®­é ­å‡½å¼ï¼Œæ‹¿åˆ°çš„ <code>this</code>æ‰æœƒæ˜¯æˆ‘å€‘è¦çš„åœ–è¡¨å¯¦ä¾‹ç‰©ä»¶ï¼ˆå¦å‰‡æœƒæ˜¯ undefinedï¼‰ã€‚ä½†åœ¨å…¶ä»–åœ°æ–¹ï¼ˆVue çš„ç’°å¢ƒä¸­ï¼‰å‰‡è¦é€éè¨ªå• DOM å…ƒç´ æ‰èƒ½å¾—åˆ°åœ–è¡¨å¯¦ä¾‹ç‰©ä»¶ã€‚<br>ç›®å‰çš„æ–¹æ³•æ˜¯é€™æ¨£ï¼Œä½†å…¶å¯¦å®˜æ–¹å¥½åƒæœ‰æä¾›å…¶ä»–å¯ä»¥è¨ªå• <code>options</code>çš„ APIï¼ˆå¦‚ <code>computedOptions</code>ï¼Œå¯åƒè€ƒ<a href="https://github.com/ecomfe/vue-echarts#computed" target="_blank" rel="noopener">æ–‡ä»¶</a>ï¼‰ ï¼Œä½†æˆ‘ç›®å‰æ˜¯éƒ½æ²’æœ‰æˆåŠŸé QwQï¼Œå¯èƒ½é‚„éœ€å¦å¤–ç ”ç©¶ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬ä¸€æ¬¡ä½¿ç”¨ Echarts é€™å¥—åœ–å½¢ libraryï¼Œåœ¨ vue ä¸­ä½¿ç”¨ Echarts å¯ä»¥ç›´æ¥è£ vue-echartï¼Œå®˜æ–¹æ–‡ä»¶æ¨è–¦å…©å€‹éƒ½è£ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm install echarts vue-echarts&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;é æ–™ä¹‹ä¸­çš„è¸©äº†ä¸å°‘å‘ï¼Œåœ¨æ­¤ç´€éŒ„ä¸€äº›é‡é»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="https://linxinemily.github.io/categories/Vue/"/>
    
    
  </entry>
  
</feed>
